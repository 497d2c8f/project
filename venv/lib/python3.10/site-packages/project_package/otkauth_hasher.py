from django.contrib.auth.hashers import *
from django.utils.translation import gettext_lazy as _


class OTKAuthHasher(BasePasswordHasher):

	algorithm = "otkauth_hasher"
	iterations = 0
	digest = None

	def verify(self, password, encoded):
		if isinstance(password, bytes) and len(password) <= 1024 :
			return True
		else:
			return False

	def encode(self, password, salt):
		return password

	def safe_summary(self, encoded):
		return {
			_("algorithm"): "algorithm",
			_("iterations"): "iterations",
			_("salt"): "salt",
			_("hash"): "hash"
		}
